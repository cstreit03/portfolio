<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <figure><img alt="Screenshot of a Device in ConnectWise with Custom Fields" src="https://cdn-images-1.medium.com/max/1024/1*1VKP5Vlul-AV_guHnU_zzw.png"><figcaption>Screenshot of a Device in ConnectWise with Custom Fields</figcaption></figure> <p>Remote Monitoring and Management (RMM) software allows IT and security administrators to monitor company devices remotely. A popular vendor called ConnectWise provides many functionalities that make management easier. The Custom Fields feature allows quick access to crucial information and can be found by clicking on a device and choosing the <strong>Custom Fields</strong> tab.</p> <h3>Benefits of using Custom Fields</h3> <p>Custom Fields allow you to automatically gather crucial information for endpoints using Tasks. In this article, we are going to create one that stores BitLocker keys and setup the associated Task to obtain the BitLocker keys. With a few simple tweaks to the steps in this guide, you could potentially track the firewall status or count the failed login attempts on a device.</p> <blockquote> <strong>Pro Tip:</strong> You can also create custom monitors in ConnectWise that will alert you if a device doesn’t have BitLocker enabled. Similar configurations can be made to detect failed logins and more.</blockquote> <h3>How to create Custom Fields</h3> <p>To get started, let’s create a Custom Field by following these steps:</p> <ol> <li>Login to your ConnectWise RMM dashboard and navigate to <strong>“Settings”</strong> </li> <li>Under the <strong>“Settings”</strong> drop-down menu, click <strong>“Custom Fields”</strong> </li> <li>Next, choose <strong>“Add”</strong> and you should see some options appear</li> <li>Fill in the following details and click <strong>“Save”</strong>:<br> — <strong>Name</strong> = BitLocker Key<br> — <strong>Level</strong> = ENDPOINT<br> — <strong>Type</strong> = Text Box<br> — <strong>Default value</strong> = 0 <em>(that is the number zero)</em><br> — <strong>Description</strong> = Displays the BitLocker Key<br> — <strong>Editable</strong> = No</li> </ol> <figure><img alt="Screenshot of the configured Custom Field" src="https://cdn-images-1.medium.com/max/1024/1*X4e5jhDr2MEDMzBMf5Udqw.png"><figcaption>Screenshot of the configured Custom Field</figcaption></figure> <h3>How to create a Task to update Custom Fields</h3> <p>Once the Custom Field is setup, create a Task like the below:</p> <ol> <li>In ConnectWise RMM, choose <strong>“Automation” </strong>from the menu</li> <li>From the list, click on the <strong>“Tasks”</strong> option</li> <li>Under <strong>“Tasks”</strong>, choose <strong>“Add” </strong>then click <strong>“Script Editor”</strong> </li> </ol> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*ngOKhV-xWX7-xtX555hj7w.png"></figure> <p>From here, you will want to name the script something recognizable, and write a brief description. You can also choose a category — I picked <strong>“Security.”</strong> Do not setup any parameters since this task does not use them.</p> <p>At this point, the task should look like this:</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Htkv72qNDEQSRqG_OOZ5Ug.png"></figure> <p>Next, click on the <strong>“Script Editor”</strong> tab. We will need to add two rows here — the first will retrieve the BitLocker key from the device while the second will add the BitLocker key to the Custom Field.</p> <p><strong>Row #1 — Retrieve the BitLocker key with PowerShell</strong></p> <ol> <li>Click <strong>“Add Row”</strong> </li> <li>Change the function to <strong>“PowerShell script”</strong> </li> <li>Paste this command into the editor:</li> </ol> <pre>(Get-BitLockerVolume -MountPoint C).KeyProtector.RecoveryPassword</pre> <p>I also changed the expected execution time to 600 seconds to allow plenty of time for endpoints to run the command. Once done, click <strong>“Save.”</strong></p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/800/1*b-K6aXkfeTNwwMYBJ2BZQQ.gif"><figcaption>Adding the PowerShell command to retrieve BitLocker keys</figcaption></figure> <p><strong>Row #2 — Add the BitLocker key to the Custom Field</strong></p> <ol> <li>Click <strong>“Add Row”</strong> </li> <li>Change the function to <strong>“Set Custom Field”</strong> </li> <li>In the editor that appears, change the custom field to <strong>“BitLocker Key”</strong> </li> <li>Change the value to <strong>%output%</strong> </li> <li>Click <strong>“Save”</strong> </li> </ol> <p>The %output% variable will take all the output that is generated by the PowerShell command.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/800/1*a-tGnVioh0Oc_oIOyntqIA.gif"><figcaption>Adding the function to change the custom fields</figcaption></figure> <p>At this point, you should save the task by clicking the “Save” button in the top corner.</p> <h3>How to schedule the Task</h3> <p>You might be asking, what good are all of these configurations if we don’t run them? Before you run the newly created task against all of your clients, I would recommend testing the task on a few devices first.</p> <ol> <li>In ConnectWise RMM, choose <strong>“Automation” </strong>from the menu</li> <li>From the list, click on the <strong>“Tasks”</strong> option</li> <li>Under <strong>“Tasks”</strong>, search for the task you created</li> <li>Once found, click the name and choose <strong>“Schedule”</strong> </li> </ol> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*a1DGj3cCIIh87amNWzK6fA.png"></figure> <p>This should bring up the scheduling menu. From here, you can schedule the task to occur periodically or simply run it once. For the purposes of this guide, we will only run it once.</p> <blockquote> <strong>IMPORTANT:</strong> When scheduling the task for the first time, you should only apply it to a few devices for testing purposes. After a successful test, you can select your <strong>Windows Server</strong> and <strong>Windows Desktop</strong> device groups to apply it to all companies. You can also run the task for a specific company depending on your specific needs.</blockquote> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*enMmthr4TP1QOlApMlaAOw.png"></figure> <p>Once the scheduled task completes, you can find a device and select the <strong>“Custom Fields”</strong> tab to see the BitLocker key conveniently located there.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*1VKP5Vlul-AV_guHnU_zzw.png"></figure> <h3>Conclusion</h3> <p>Custom Fields can greatly improve the efficiency of your information technology teams as shown above. Unfortunately, endpoints must be online while the task is running for the BitLocker Key to appear. Since endpoints are typically online at random times, it helps to schedule the task to run periodically. Scheduling such an automation also keeps the keys up-to-date automatically if a key ever changes.</p> <p>Did you find this article useful? I’d love to hear your feedback!</p> <p><img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=4a8a69b01b6a" width="1" height="1" alt=""></p> </body></html>